import requests
import json
from selenium import webdriver
from selenium.webdriver.edge.service import Service
import pandas as pd #数据导出

df=pd.DataFrame(columns=["序列","求职者ID","姓名","预期岗位","经验","学历","最低薪资","最高薪资","所在地"])


# 初始化webdriver
wd = webdriver.Chrome(service=Service(r'C:\Program Files\Google\Chrome\Application\chromedriver.exe'))

# 打开起始页面
start_url = 'https://www.5iai.com/#/moreResume'
wd.get(start_url)


num=0
for page in range(1,1094):
    headers = {
    'User-Agent':'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/112.0.0.0 Safari/537.36 Edg/112.0.1722.48'
    }

    url = f'https://www.5iai.com/api/resume/baseInfo/public/es?pageSize=10&pageNumber={page}&function=&skills=&workplace=&keyword='
    data1 = {
        'pageSize':1094,
        'pageNumber':page
    }
    page +=1
    response = requests.get(url=url, headers=headers,data=data1)


    data = json.loads(response.text)

    res = data['data']['content']


    for index in res:
        #1
        id = index["id"] # id
        userName = index['username'] #称谓
        gender = index['gender']# 性别
        expect = index['expectPosition']# 期望岗位
        # expect = ''.join(index['expectPosition'])# 期望岗位
        jobStatus = index['jobStatus']# 在职状态1，2，3 毕业找工作， ，在职换工作
        minmoney = index['willSalaryStart']# 最低工资
        maxmoney = index['willSalaryEnd']# 最高工资
        city = index['city']#所在地
        # city = ''.join(index['city'])#所在地
        education = index['jobStatus']#学历要求
        body_num = ['count']# 招聘人数
        date = index['updateTime']# 招聘发布时间
        # date = index['']# 招聘详细页
        exp = index['exp']  # 工作经验
        updateTime = index['updateTime']# 提交时间

        print('',id, userName, expect, exp, education, minmoney, maxmoney, city,education,body_num,date,exp,updateTime)  # count

        num += 1
        df.loc[len(df.index)] = [num, id, userName, expect, exp, education, minmoney, maxmoney, city,education,body_num,date,exp,updateTime]  # 每打印一页就把这些插入

    df.to_excel("result1-2.xlsx", index=False, sheet_name="result1-2", na_rep="")
